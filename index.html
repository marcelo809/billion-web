<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>BILLION — Advisor Operating System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root{
      --bg:#0b0f19;
      --panel:#0f1626;
      --card:#111b30;
      --card2:#0f192e;
      --text:#e7eefc;
      --muted:#9aa4b2;
      --border:rgba(255,255,255,.08);
      --shadow: 0 20px 60px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:14px;
      --accent:#7c3aed; /* morado */
      --ok:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,Inter,system-ui,"Segoe UI",Roboto,Arial,sans-serif;
      background: radial-gradient(1200px 700px at 20% 10%, rgba(124,58,237,.18), transparent 60%),
                  radial-gradient(900px 600px at 80% 0%, rgba(34,197,94,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
    }

    a{color:inherit; text-decoration:none}
    .app{
      display:grid;
      grid-template-columns: 280px 1fr;
      min-height:100vh;
    }

    /* Sidebar */
    .sidebar{
      padding:22px 18px;
      border-right:1px solid var(--border);
      background: linear-gradient(180deg, rgba(15,22,38,.92), rgba(11,15,25,.86));
      position:sticky; top:0; height:100vh;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      padding:10px 10px 18px;
    }
    .logo{
      width:38px; height:38px; border-radius:12px;
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(59,130,246,.55));
      box-shadow: 0 10px 30px rgba(124,58,237,.25);
    }
    .brand h1{margin:0; font-size:16px; letter-spacing:.5px}
    .brand p{margin:2px 0 0; font-size:12px; color:var(--muted)}
    .nav{
      margin-top:6px;
      display:flex; flex-direction:column; gap:6px;
    }
    .nav button{
      width:100%;
      background:transparent;
      border:1px solid transparent;
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      text-align:left;
      display:flex; align-items:center; justify-content:space-between;
      cursor:pointer;
      transition:.15s ease;
    }
    .nav button:hover{
      background:rgba(255,255,255,.04);
      border-color:rgba(255,255,255,.06);
    }
    .nav button.active{
      background:rgba(124,58,237,.14);
      border-color:rgba(124,58,237,.35);
    }
    .pill{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      color:var(--muted);
    }
    .sidebar .sectionTitle{
      margin:18px 10px 8px;
      font-size:11px;
      color:var(--muted);
      letter-spacing:.12em;
      text-transform:uppercase;
    }
    .sidebarCard{
      margin:10px;
      padding:14px;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(17,27,48,.85), rgba(15,25,46,.65));
      border:1px solid rgba(255,255,255,.08);
    }
    .sidebarCard .small{
      font-size:12px; color:var(--muted); margin:0 0 6px;
    }
    .sidebarCard .big{
      font-size:18px; font-weight:700; margin:0;
    }
    .sidebarCard .row{
      display:flex; gap:10px; margin-top:10px;
    }
    .tag{
      font-size:11px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      color:var(--muted);
    }

    /* Main */
    .main{
      padding:22px 26px 60px;
    }
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px;
      margin-bottom:18px;
    }
    .search{
      flex:1;
      display:flex; align-items:center; gap:10px;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(15,22,38,.55);
      backdrop-filter: blur(8px);
    }
    .search input{
      width:100%;
      border:none;
      outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .actions{
      display:flex; gap:10px;
    }
    .btn{
      border:none;
      cursor:pointer;
      padding:11px 14px;
      border-radius:14px;
      font-weight:650;
      transition:.15s ease;
    }
    .btn.primary{
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(59,130,246,.65));
      color:white;
      box-shadow: 0 14px 45px rgba(124,58,237,.22);
    }
    .btn.primary:hover{transform: translateY(-1px)}
    .btn.ghost{
      background:rgba(255,255,255,.04);
      color:var(--text);
      border:1px solid rgba(255,255,255,.10);
    }

    .pageTitle{
      display:flex; align-items:flex-end; justify-content:space-between;
      margin:12px 0 18px;
    }
    .pageTitle h2{margin:0; font-size:28px; letter-spacing:.2px}
    .pageTitle p{margin:6px 0 0; color:var(--muted); font-size:14px}

    /* Cards grid */
    .grid4{
      display:grid;
      grid-template-columns: repeat(4, minmax(220px, 1fr));
      gap:14px;
    }
    @media (max-width: 1200px){
      .app{grid-template-columns: 84px 1fr}
      .brandText{display:none}
      .sidebar{padding:18px 12px}
      .nav button{justify-content:center}
      .nav button span.label{display:none}
      .nav button .pill{display:none}
      .sidebarCard{display:none}
    }
    @media (max-width: 980px){
      .grid4{grid-template-columns: repeat(2, minmax(220px, 1fr));}
    }
    @media (max-width: 560px){
      .grid4{grid-template-columns: 1fr;}
      .topbar{flex-direction:column; align-items:stretch}
      .actions{justify-content:stretch}
      .btn{width:100%}
    }

    .card{
      background: linear-gradient(180deg, rgba(17,27,48,.90), rgba(15,25,46,.72));
      border:1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      padding:16px 16px 14px;
      box-shadow: var(--shadow);
    }
    .cardHeader{
      display:flex; align-items:center; justify-content:space-between;
      margin-bottom:10px;
    }
    .kpiLabel{color:var(--muted); font-size:12px}
    .kpiValue{font-size:30px; font-weight:800; letter-spacing:.2px}
    .kpiSub{margin-top:6px; color:var(--muted); font-size:12px}
    .badge{
      font-size:11px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      color:var(--muted);
    }
    .badge.ok{border-color:rgba(34,197,94,.35); color:rgba(34,197,94,.9)}
    .badge.warn{border-color:rgba(245,158,11,.35); color:rgba(245,158,11,.95)}
    .badge.bad{border-color:rgba(239,68,68,.35); color:rgba(239,68,68,.92)}

    /* Sections */
    .twoCol{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 980px){
      .twoCol{grid-template-columns:1fr}
    }
    .section{
      padding:16px;
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.08);
      background: rgba(15,22,38,.45);
      backdrop-filter: blur(8px);
    }
    .section h3{margin:0 0 10px; font-size:16px}
    .muted{color:var(--muted)}
    .qa{
      display:flex; flex-wrap:wrap; gap:10px;
    }
    .qa .quick{
      flex: 1 1 180px;
      border-radius:16px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      padding:12px;
    }
    .quick .t{font-weight:750; margin:0 0 6px}
    .quick .d{margin:0; color:var(--muted); font-size:12px}
    .quick button{
      margin-top:10px;
      width:100%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
      color:var(--text);
      cursor:pointer;
    }
    .quick button:hover{background:rgba(255,255,255,.06)}

    /* Table */
    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0 10px;
    }
    th{
      text-align:left;
      font-size:11px;
      color:var(--muted);
      font-weight:650;
      letter-spacing:.08em;
      text-transform:uppercase;
      padding:0 10px;
    }
    td{
      padding:12px 10px;
      background: rgba(255,255,255,.04);
      border-top:1px solid rgba(255,255,255,.08);
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    tr td:first-child{
      border-left:1px solid rgba(255,255,255,.08);
      border-top-left-radius:14px;
      border-bottom-left-radius:14px;
    }
    tr td:last-child{
      border-right:1px solid rgba(255,255,255,.08);
      border-top-right-radius:14px;
      border-bottom-right-radius:14px;
    }
    .ticker{
      font-weight:800;
      letter-spacing:.2px;
    }
    .sub{
      display:block;
      color:var(--muted);
      font-size:12px;
      margin-top:2px;
    }
    .pos{
      color: rgba(34,197,94,.95);
      font-weight:750;
    }
    .neg{
      color: rgba(239,68,68,.95);
      font-weight:750;
    }

    /* Hidden pages */
    .page{display:none}
    .page.active{display:block}

    /* Modal */
    .modalOverlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      display:none; align-items:center; justify-content:center;
      padding:18px;
    }
    .modal{
      width:min(720px, 100%);
      border-radius:22px;
      background: linear-gradient(180deg, rgba(17,27,48,.98), rgba(15,25,46,.92));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 30px 90px rgba(0,0,0,.55);
      padding:18px;
    }
    .modalTop{
      display:flex; align-items:center; justify-content:space-between;
      margin-bottom:10px;
    }
    .modalTop h4{margin:0; font-size:16px}
    .x{
      background:transparent; border:none; color:var(--muted);
      font-size:20px; cursor:pointer;
    }
    .drop{
      border-radius:18px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.03);
      padding:14px;
    }
    .drop p{margin:6px 0; color:var(--muted); font-size:13px}
    .drop input{width:100%}
    .hint{font-size:12px; color:var(--muted); margin-top:10px}
  </style>
</head>

<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo"></div>
        <div class="brandText">
          <h1>BILLION</h1>
          <p>Advisor Operating System</p>
        </div>
      </div>

      <div class="nav" id="nav">
        <button class="active" data-page="home">
          <span class="label">Home</span>
          <span class="pill">Dashboard</span>
        </button>
        <button data-page="portfolio">
          <span class="label">Portfolio</span>
          <span class="pill">Positions</span>
        </button>
        <button data-page="reports">
          <span class="label">Reports</span>
          <span class="pill">LSEG PDF</span>
        </button>
        <button data-page="ops">
          <span class="label">Ops</span>
          <span class="pill">Tasks</span>
        </button>
      </div>

      <div class="sectionTitle">Today</div>
      <div class="sidebarCard">
        <p class="small">Portfolio NAV</p>
        <p class="big" id="sbNav">$3,698</p>
        <div class="row">
          <span class="tag">Benchmark: QQQ</span>
          <span class="tag">Mode: MVP</span>
        </div>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <div class="topbar">
        <div class="search">
          <span style="color:var(--muted)">⌘K</span>
          <input id="search" placeholder="Buscar: ticker, cliente, reporte, tarea…" />
        </div>
        <div class="actions">
          <button class="btn ghost" id="openUpload">Upload LSEG PDF</button>
          <button class="btn primary" id="newReport">Generate Report</button>
        </div>
      </div>

      <!-- HOME -->
      <section class="page active" id="page-home">
        <div class="pageTitle">
          <div>
            <h2>Command Center</h2>
            <p>Visión rápida + acciones clave para operar como RIA.</p>
          </div>
          <div class="badge ok">LIVE</div>
        </div>

        <div class="grid4">
          <div class="card">
            <div class="cardHeader">
              <div class="kpiLabel">Portfolio Value</div>
              <div class="badge">NAV</div>
            </div>
            <div class="kpiValue" id="kpiNav">$3,698</div>
            <div class="kpiSub">As of today • Cash + positions</div>
          </div>

          <div class="card">
            <div class="cardHeader">
              <div class="kpiLabel">Daily P&L</div>
              <div class="badge bad">Day</div>
            </div>
            <div class="kpiValue" id="kpiDay">-0.43%</div>
            <div class="kpiSub">Tracking day move</div>
          </div>

          <div class="card">
            <div class="cardHeader">
              <div class="kpiLabel">AI Risk Score</div>
              <div class="badge warn">Model v0</div>
            </div>
            <div class="kpiValue" id="kpiRisk">72 / 100</div>
            <div class="kpiSub">Heurístico (por ahora)</div>
          </div>

          <div class="card">
            <div class="cardHeader">
              <div class="kpiLabel">Benchmark vs QQQ</div>
              <div class="badge ok">Relative</div>
            </div>
            <div class="kpiValue" id="kpiBench">+1.8%</div>
            <div class="kpiSub">Excess return vs QQQ</div>
          </div>
        </div>

        <div class="twoCol">
          <div class="section">
            <h3>Quick Actions</h3>
            <p class="muted" style="margin-top:0">Acciones para operar y producir reportes en minutos.</p>

            <div class="qa">
              <div class="quick">
                <p class="t">Subir PDF LSEG</p>
                <p class="d">Cargar reporte manual (PDF) para extraer métricas y guardarlas.</p>
                <button id="qaUpload">Upload</button>
              </div>
              <div class="quick">
                <p class="t">Generar Reporte Maestro</p>
                <p class="d">Plantilla pro: overview, datos clave, positives/negatives, recomendación.</p>
                <button id="qaReport">Generate</button>
              </div>
              <div class="quick">
                <p class="t">Actualizar Benchmark (QQQ)</p>
                <p class="d">Set QQQ como benchmark por defecto y recalcular.</p>
                <button id="qaQQQ">Recalculate</button>
              </div>
              <div class="quick">
                <p class="t">Crear Tarea Operativa</p>
                <p class="d">Checklist RIA: onboarding, suitability, IPS, rebalance, follow-up.</p>
                <button id="qaTask">Add Task</button>
              </div>
            </div>
          </div>

          <div class="section">
            <h3>Today Focus</h3>
            <p class="muted" style="margin-top:0">3 acciones recomendadas para avanzar el sistema.</p>
            <ol class="muted" style="line-height:1.7">
              <li>Subir 1 PDF LSEG y capturar “Key Stats”.</li>
              <li>Definir 1 cliente demo + portafolio.</li>
              <li>Generar 1 reporte maestro (ticker nuevo).</li>
            </ol>
            <div class="hint">Siguiente fase: datos reales, parsing de PDF, métricas (Sharpe, beta, drawdown, tracking error).</div>
          </div>
        </div>
      </section>

      <!-- PORTFOLIO -->
      <section class="page" id="page-portfolio">
        <div class="pageTitle">
          <div>
            <h2>Portfolio</h2>
            <p>Posiciones + métricas. Benchmark por defecto: QQQ.</p>
          </div>
          <div class="badge">MVP data</div>
        </div>

        <div class="section">
          <h3>Positions</h3>
          <p class="muted" style="margin-top:0">Datos demo — luego lo conectamos a tu broker / CSV / PDF.</p>

          <table>
            <thead>
              <tr>
                <th>Instrument</th>
                <th>Last</th>
                <th>Qty</th>
                <th>P&L</th>
              </tr>
            </thead>
            <tbody id="positionsBody"></tbody>
          </table>
        </div>
      </section>

      <!-- REPORTS -->
      <section class="page" id="page-reports">
        <div class="pageTitle">
          <div>
            <h2>Reports</h2>
            <p>Sube PDF (LSEG) y genera reporte maestro en formato RIA.</p>
          </div>
          <div class="badge warn">Manual PDF</div>
        </div>

        <div class="section">
          <h3>Upload LSEG PDF</h3>
          <p class="muted" style="margin-top:0">Por ahora solo guardamos archivo + metadata (nombre/ticker). Parsing viene en fase 2.</p>
          <button class="btn ghost" id="openUpload2">Subir PDF</button>
          <p class="hint">Tip: nómbralo así: <b>TICKER - 02 2026.pdf</b></p>
        </div>

        <div class="section" style="margin-top:14px">
          <h3>Reporte Maestro (Preview)</h3>
          <p class="muted" style="margin-top:0">Plantilla lista para llenar automáticamente.</p>
          <div class="card" style="margin-top:10px; box-shadow:none">
            <div class="kpiLabel">Ejemplo</div>
            <div style="margin-top:10px; line-height:1.6; color:var(--text)">
              <b>RACE — Ferrari N.V.</b><br/>
              <span class="muted">Perspectiva General:</span> Compañía líder en autos deportivos de lujo…<br/>
              <span class="muted">Datos Clave del Ticker:</span> Precio, market cap, 52w, P/E, ROE…<br/>
              <span class="muted">Puntos Positivos:</span> Marca, pricing power, márgenes…<br/>
              <span class="muted">Puntos Negativos:</span> Ciclo lujo, FX, concentración…<br/>
              <span class="muted">Conclusión:</span> Mantener/Comprar/Vender + perfil…
            </div>
          </div>
        </div>
      </section>

      <!-- OPS -->
      <section class="page" id="page-ops">
        <div class="pageTitle">
          <div>
            <h2>Ops</h2>
            <p>Tareas + checklist operativo para dejar el sistema listo antes de tu salida.</p>
          </div>
          <div class="badge">Workflow</div>
        </div>

        <div class="section">
          <h3>Task List</h3>
          <p class="muted" style="margin-top:0">MVP: guardamos tasks en tu navegador (localStorage).</p>

          <div style="display:flex; gap:10px; margin:10px 0 14px">
            <input id="taskInput" placeholder="Ej: Generar reporte maestro de RACE" style="
              flex:1; padding:12px 14px; border-radius:14px;
              border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.04);
              color:var(--text); outline:none;
            "/>
            <button class="btn primary" id="addTask">Add</button>
          </div>

          <div id="taskList"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal Upload -->
  <div class="modalOverlay" id="modal">
    <div class="modal">
      <div class="modalTop">
        <h4>Upload LSEG PDF</h4>
        <button class="x" id="closeModal">×</button>
      </div>

      <div class="drop">
        <input type="file" id="fileInput" accept=".pdf"/>
        <p>Selecciona un PDF. Guardaremos nombre + fecha (parsing viene en fase 2).</p>
        <p class="hint" id="fileInfo"></p>
      </div>

      <div style="display:flex; gap:10px; margin-top:12px">
        <button class="btn ghost" id="clearFile">Clear</button>
        <button class="btn primary" id="saveFile">Save (local)</button>
      </div>
      <div class="hint">Nota: GitHub Pages no tiene backend. En fase 2 guardaremos en DB (Supabase/Firebase) o en tu servidor.</div>
    </div>
  </div>

  <script>
    // -------- NAV ----------
    const nav = document.getElementById('nav');
    const pages = {
      home: document.getElementById('page-home'),
      portfolio: document.getElementById('page-portfolio'),
      reports: document.getElementById('page-reports'),
      ops: document.getElementById('page-ops')
    };

    nav.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-page]');
      if(!btn) return;
      const page = btn.getAttribute('data-page');

      [...nav.querySelectorAll('button')].forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      Object.values(pages).forEach(p => p.classList.remove('active'));
      pages[page].classList.add('active');
    });

    // -------- POSITIONS (demo) ----------
    const positions = [
      { ticker:'AAPL', venue:'NASDAQ', last:262.92, qty:1, pnl:-1.27 },
      { ticker:'AUR',  venue:'NASDAQ', last:4.67,   qty:10, pnl:-0.60 },
      { ticker:'B',    venue:'NYSE',   last:47.72,  qty:15, pnl:-7.43 },
      { ticker:'HIMS', venue:'NYSE',   last:15.82,  qty:2,  pnl:-0.04 },
      { ticker:'LMT',  venue:'NYSE',   last:657.47, qty:1,  pnl:17.47 },
      { ticker:'PLTM', venue:'ARCA',   last:19.80,  qty:10, pnl:-2.00 },
      { ticker:'PLTR', venue:'NASDAQ', last:133.13, qty:5,  pnl:-10.65 },
      { ticker:'QQQ',  venue:'NASDAQ', last:601.58, qty:1,  pnl:-4.14 },
      { ticker:'SOFI', venue:'NASDAQ', last:19.25,  qty:10, pnl:-2.95 },
      { ticker:'URA',  venue:'ARCA',   last:52.01,  qty:4,  pnl:-3.76 },
    ];

    const tbody = document.getElementById('positionsBody');
    function renderPositions(){
      tbody.innerHTML = '';
      positions.forEach(p => {
        const tr = document.createElement('tr');
        const pnlClass = p.pnl >= 0 ? 'pos' : 'neg';
        tr.innerHTML = `
          <td>
            <span class="ticker">${p.ticker}</span>
            <span class="sub">${p.venue}</span>
          </td>
          <td>${p.last.toFixed(2)}</td>
          <td>${p.qty}</td>
          <td class="${pnlClass}">${p.pnl >= 0 ? '+' : ''}${p.pnl.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
      });
    }
    renderPositions();

    // -------- MODAL ----------
    const modal = document.getElementById('modal');
    const openUpload = document.getElementById('openUpload');
    const openUpload2 = document.getElementById('openUpload2');
    const closeModal = document.getElementById('closeModal');
    const qaUpload = document.getElementById('qaUpload');
    const fileInput = document.getElementById('fileInput');
    const fileInfo = document.getElementById('fileInfo');
    const clearFile = document.getElementById('clearFile');
    const saveFile = document.getElementById('saveFile');

    function showModal(){ modal.style.display='flex'; }
    function hideModal(){ modal.style.display='none'; }

    [openUpload, openUpload2, qaUpload].forEach(el => el && el.addEventListener('click', showModal));
    closeModal.addEventListener('click', hideModal);
    modal.addEventListener('click', (e) => { if(e.target === modal) hideModal(); });

    fileInput.addEventListener('change', () => {
      const f = fileInput.files?.[0];
      if(!f) { fileInfo.textContent = ''; return; }
      fileInfo.textContent = `Selected: ${f.name} (${Math.round(f.size/1024)} KB)`;
    });

    clearFile.addEventListener('click', () => {
      fileInput.value = '';
      fileInfo.textContent = '';
    });

    saveFile.addEventListener('click', () => {
      const f = fileInput.files?.[0];
      if(!f){ alert('Selecciona un PDF primero'); return; }
      const saved = JSON.parse(localStorage.getItem('billion_pdfs') || '[]');
      saved.unshift({ name: f.name, size: f.size, ts: Date.now() });
      localStorage.setItem('billion_pdfs', JSON.stringify(saved.slice(0,25)));
      alert('Guardado (local). Fase 2: backend/DB.');
      hideModal();
    });

    // -------- REPORT button (MVP) ----------
    const newReport = document.getElementById('newReport');
    const qaReport = document.getElementById('qaReport');
    function reportAction(){
      alert('MVP: En fase 2 generaremos el reporte maestro automáticamente (con parsing + LLM).');
      // ir a Reports
      nav.querySelector('button[data-page="reports"]').click();
    }
    newReport.addEventListener('click', reportAction);
    qaReport.addEventListener('click', reportAction);

    // -------- QQQ recalculation (MVP) ----------
    document.getElementById('qaQQQ').addEventListener('click', () => {
      alert('MVP: En fase 2 calculamos beta, tracking error y excess return vs QQQ con datos reales.');
    });

    // -------- TASKS (localStorage) ----------
    const taskInput = document.getElementById('taskInput');
    const addTaskBtn = document.getElementById('addTask');
    const taskList = document.getElementById('taskList');

    function loadTasks(){
      return JSON.parse(localStorage.getItem('billion_tasks') || '[]');
    }
    function saveTasks(tasks){
      localStorage.setItem('billion_tasks', JSON.stringify(tasks));
    }
    function renderTasks(){
      const tasks = loadTasks();
      if(tasks.length === 0){
        taskList.innerHTML = `<p class="muted">No tasks yet. Agrega la primera.</p>`;
        return;
      }
      taskList.innerHTML = '';
      tasks.forEach((t, idx) => {
        const row = document.createElement('div');
        row.style.display='flex';
        row.style.alignItems='center';
        row.style.justifyContent='space-between';
        row.style.gap='10px';
        row.style.padding='10px 12px';
        row.style.borderRadius='14px';
        row.style.border='1px solid rgba(255,255,255,.10)';
        row.style.background='rgba(255,255,255,.04)';
        row.style.marginBottom='10px';

        row.innerHTML = `
          <div style="display:flex; align-items:center; gap:10px">
            <input type="checkbox" ${t.done ? 'checked' : ''} data-idx="${idx}" />
            <div>
              <div style="font-weight:750; ${t.done ? 'text-decoration:line-through; color:rgba(154,164,178,.9)' : ''}">${t.text}</div>
              <div class="muted" style="font-size:12px">${new Date(t.ts).toLocaleString()}</div>
            </div>
          </div>
          <button data-del="${idx}" class="btn ghost" style="padding:8px 10px; border-radius:12px">Delete</button>
        `;
        taskList.appendChild(row);
      });
    }

    addTaskBtn.addEventListener('click', () => {
      const v = taskInput.value.trim();
      if(!v) return;
      const tasks = loadTasks();
      tasks.unshift({ text:v, done:false, ts: Date.now() });
      saveTasks(tasks.slice(0,50));
      taskInput.value='';
      renderTasks();
    });

    document.getElementById('qaTask').addEventListener('click', () => {
      nav.querySelector('button[data-page="ops"]').click();
      taskInput.focus();
      taskInput.value = 'Checklist: generar reporte maestro + benchmark vs QQQ';
    });

    taskList.addEventListener('click', (e) => {
      const del = e.target.closest('button[data-del]');
      if(del){
        const idx = Number(del.getAttribute('data-del'));
        const tasks = loadTasks();
        tasks.splice(idx,1);
        saveTasks(tasks);
        renderTasks();
      }
    });
    taskList.addEventListener('change', (e) => {
      const cb = e.target.closest('input[type="checkbox"][data-idx]');
      if(!cb) return;
      const idx = Number(cb.getAttribute('data-idx'));
      const tasks = loadTasks();
      tasks[idx].done = cb.checked;
      saveTasks(tasks);
      renderTasks();
    });

    renderTasks();

    // Search placeholder (MVP)
    document.getElementById('search').addEventListener('keydown', (e) => {
      if(e.key === 'Enter'){
        alert('MVP: Search global viene en fase 2 (clientes/tickers/reportes).');
      }
    });
  </script>
</body>
</html>
